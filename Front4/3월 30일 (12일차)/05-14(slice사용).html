<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>ex08</title>
    <style>
        * {
            box-sizing: border-box;
        }

        ul {
            margin: 0;
            padding: 0;
        }

        ul li {
            cursor: pointer;
            position: relative;
            padding: 8px 8px 8px 40px;
            background: #eee;
            font-size: 14px;
            transition: 0.2s;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        ul li:hover {
            background: #ddd;
        }

        ul li.checked {
            background: #BBB;
            color: #fff;
            text-decoration: line-through;
        }

        ul li.checked::before {
            content: '';
            position: absolute;
            border-color: #fff;
            border-style: solid;
            border-width: 0px 1px 1px 0px;
            top: 10px;
            left: 16px;
            transform: rotate(45deg);
            height: 8px;
            width: 8px;
        }

        .close {
            position: absolute;
            right: 0;
            top: 0;
            padding: 12px 16px 12px 16px
        }

        .close:hover {
            background-color: #f44336;
            color: white;
        }

        .header {
            background-color: purple;
            padding: 30px 30px;
            color: yellow;
            text-align: center;
        }

        .header:after {
            content: "";
            display: table;
            clear: both;
        }

        .input {
            border: none;
            width: 75%;
            height: 35px;
            padding: 10px;
            float: left;
            font-size: 16px;
        }

        .addbutton {
            padding: 10px;
            width: 25%;
            height: 35px;
            background: #d9d9d9;
            color: #555;
            float: left;
            text-align: center;
            font-size: 13px;
            cursor: pointer;
            transition: 0.3s;
        }

        .addbutton:hover {
            background-color: #bbb;
        }

        .completed {
            text-decoration: none;
        }
    </style>
    <script src="https://unpkg.com/vue@2.5.16/dist/vue.js"></script>
</head>

<body>

    <div id="todolistapp">
        <div id="header" class="header">
            <h2>Todo List App</h2>
            <input class="input" type="text" id="task" v-model="todo" placeholder="입력 후 엔터!">
            <span class="addbutton" v-on:click="addTodo()">추가</span>
        </div>
        <ul id="todolist">
            <!--JSON배열값을 li에 할당해서, 반복 렌더링-->
            <!--각각의 li를 클릭했을때 done->true->fasle -->
            <!--done값이 true...checked속성 됬다. 안됬다. -->
            <!--토글 기능으로 누르면 됬다가, 안됬다가... -->

            <li v-for="a in todolist" v-on:click="doneToggle(a.id)" v-bind:class="checked(a.done)">
                <!--li에 v-on:click 이벤트 적용 -->
                <!--JSON배열 todolist에서 객체 하나씩 a로 가져와서...-->
                <span>{{a.todo}}</span>
                <span v-if="a.done">(완료)</span>
                <span class="close" v-on:click="deleteTodo(a.id)">&#x00D7;</span>
                <!--객체 a의 todo값만 출력-->
            </li>
        </ul>
    </div>

    <script type="text/javascript">
        var vm = new Vue({
            el: '#todolistapp',
            data: {
                todo: '',
                todolist: [{
                    id: 1,
                    todo: '영화보기',
                    done: false
                }, {
                    id: 2,
                    todo: '주말 산책',
                    done: true
                }, {
                    id: 3,
                    todo: 'ES6 학습',
                    done: false
                }, {
                    id: 4,
                    todo: '잠실 야구장',
                    done: false
                }, ]
            },
            methods: {
                addTodo: function() {
                    console.log("addTodo");
                    this.todolist.push({
                        id: new Date().getTime(),
                        todo: this.todo,
                        done: false
                    });
                },
                checked: function(done) {
                    //li를 누르면
                    //li에 class="checked가 적용되게 만듬"
                    if (done) {
                        return {
                            checked: true
                        };
                    } else {
                        return {
                            checked: false
                        };
                    }
                    //v-bind:class={checked:true}
                    //v-bind:class={checked:false}
                    //v-bind:class={red:attachRed}
                },
                doneToggle: function(id) {

                    var index = this.todolist.findIndex(
                        function(item) {
                            return item.id == id;
                            //return true;
                            //return false;
                            //JSON배열에서 가져온 값의 id
                            //매개변수로 받은 값의 id
                            //비교해서
                        }
                    )
                    alert(index);

                    alert(this.todolist[index].done);
                    this.todolist[index].done = !this.todolist[index].done;
                    alert(this.todolist[index].done);

                },
                deleteTodo: function(id) {

                  var index = this.todolist.findIndex(
                      function(item) {
                          return item.id == id;
                          //return true;
                          //return false;
                          //JSON배열에서 가져온 값의 id
                          //매개변수로 받은 값의 id
                          //비교해서
                      }
                  )
                  console.log(index);
                    var length = this.todolist.length;
                    console.log(length);
                    var left=this.todolist.slice(0,index);
                    console.log(left);
                    var right=this.todolist.slice(index+1,length);
                    console.log(right);
                    var new_ary=new Array(0);
                    new_ary=left.concat(right);

                    console.log(new_ary);
                    this.todolist=new_ary;

                    console.log(this.todolist);
                }
            }
        })
    </script>
</body>

</html>
